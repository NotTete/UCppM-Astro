---
import { Image } from "astro:assets";
import HamburguerButton from "./HamburguerButton.astro";
import discordLogo from "../assets/icons/discord.svg";
import instagramLogo from "../assets/icons/instagram.svg";
import githubLogo from "../assets/icons/github.svg";
import { discordLink, instagramLink, githubLink } from "../data/links.ts";

const navbarMenu = [
    {
        name: "¿Quienes somos?",
        link: `${import.meta.env.BASE_URL}/#about`,
    },
    {
        name: "Actividades",
        link: `${import.meta.env.BASE_URL}/activities`,
    },
    {
        name: "Recursos",
        link: `${import.meta.env.BASE_URL}/resources`,
    },
    {
        name: "Contacto",
        link: `${import.meta.env.BASE_URL}/contact`,
    },
    {
        name: "FAQ",
        link: `${import.meta.env.BASE_URL}/faq`,
    },
];

const socialMenu = [
    {
        name: "instagram",
        img: instagramLogo,
        link: instagramLink,
    },
    {
        name: "discord",
        img: discordLogo,
        link: discordLink,
    },
    {
        name: "github",
        img: githubLogo,
        link: githubLink,
    },
];
---

<header class="fixed w-full   bg-bg-dark border-border border-b-1 z-50">
    <nav
        class="flex md:flex-row flex-col justify-between w-full py-2.5 gap-y-2.5 mx-auto max-w-screen-lg items-center overflow-hidden [&.open]:max-h-96 transition-[max-height] ease-in-out duration-500 max-h-16 "
        id="nav-menu"
    >
        <ul
            class="flex flex-row justify-between md:w-auto w-full items-center px-2.5"
        >
            <li
                class="text-2xl font-semibold flex items-center justify-center px-2.5 duration-150 ease-in hover:scale-[110%] transition-transform md:py-0 py-1.5"
            >
                UCppM
            </li>
            <li>
                <HamburguerButton id="menu-toggle"/>
            </li>
        </ul>

        <!-- Menú principal -->
        <ul
            class="flex md:flex-row flex-col gap-1 h-auto items-center justify-center w-full md:w-auto"
        >
            {
                navbarMenu.map((elem) => (
                    <li class="transition-colors duration-150 ease-in md:rounded-4xl md:w-auto w-full text-center p-2.5 active:bg-stone-800 hover:bg-stone-800">
                        <a href={elem.link}>{elem.name}</a>
                    </li>
                ))
            }
        </ul>
        <!-- Redes sociales y links -->
        <ul class="flex flex-row items-center justify-center text-md">
            {
                socialMenu.map((elem) => (
                    <li class="transition-colors duration-150 ease-in rounded-4xl p-2.5 hover:bg-stone-800 active:bg-stone-800">
                        <a href={elem.link}>
                            <Image
                                loading="eager"
                                src={elem.img}
                                alt={elem.name}
                                class="icon w-auto h-[1.5em]"
                            />
                        </a>
                    </li>
                ))
            }
        </ul>
    </nav>
    <div class="[&.open]:block hidden fixed w-full h-full h- z-[49]" id="overlay"></div>
</header>

<style>
    @reference "../styles/global.css";


    .icon {
        filter: invert(100%) sepia(2%) saturate(140%) hue-rotate(192deg)
            brightness(107%) contrast(78%);
    }
</style>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const button = document.getElementById("menu-toggle");
        const menu = document.getElementById("nav-menu");
        const overlay = document.getElementById("overlay");

        if (!button || !menu || !overlay) return;

        function toggleMenu() {
            const expanded = button?.getAttribute("aria-expanded") === "true";
            button?.setAttribute("aria-expanded", (!expanded).toString());
            menu?.classList.toggle("open");
            overlay?.classList.toggle("open");
        }

        function closeMenu() {
            button?.setAttribute("aria-expanded", "false");
            menu?.classList.remove("open");
            overlay?.classList.remove("open");
        }

        const styles = getComputedStyle(document.documentElement);
        const breakPoint = styles.getPropertyValue("--breakpoint-md");
        const mediaQuery = window.matchMedia(`(width < ${breakPoint})`);

        button.addEventListener("click", toggleMenu);
        overlay.addEventListener("click", closeMenu);
        mediaQuery.addEventListener("change", closeMenu);
    });
</script>
